<!DOCTYPE html>
<html>
<head>
    <title>Prescrição Digital Memed</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
      }
      #memed-container {
        width: 100vw;
        height: 100vh;
      }
    </style>
</head>
<body>

    <div id="memed-container"></div>

    <script>
      // Função para obter o valor de um parâmetro da URL (como o 'token')
      function getUrlParameter(name) {
          name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
          var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
          var results = regex.exec(location.search);
          return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
      };

      // 1. Obtém o token de acesso da URL
      var token = getUrlParameter('token');

      // 2. Verifica se o token existe. Se não, exibe uma mensagem de erro.
      if (token) {
        // 3. Se o token for encontrado, cria e injeta o elemento de script
        var script = document.createElement("script");

        // Substitua 'MEMED_SCRIPT_URL' pela URL fornecida pela Memed
        script.src = "https://integrations.memed.com.br/modulos/plataforma.sinapse-prescricao/build/sinapse-prescricao.min.js";

        // Adiciona o token como um atributo 'data-token'
        script.dataset.token = token;

        // Adiciona um listener para saber quando o script terminou de carregar
        script.addEventListener("load", function () {
          console.log("Script da Memed carregado com sucesso!");
          // A lógica da Memed deve iniciar automaticamente após o carregamento
        });

        // Adiciona o script ao corpo do documento
        document.body.appendChild(script);

      } else {
        // Exibe um erro na página se o token não for fornecido
        document.body.innerHTML = `
          <div style="padding: 20px; text-align: center;">
            <h1>Erro: Token de acesso não encontrado.</h1>
            <p>Por favor, verifique se a URL está correta e se o token foi fornecido.</p>
          </div>
        `;
        console.error("Token de acesso não encontrado na URL.");
      }
    </script>

</body>
</html>
